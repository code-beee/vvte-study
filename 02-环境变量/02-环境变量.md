# ç¯å¢ƒå˜é‡

## ğŸ˜´ åŠŸè¯¾

### .envæ–‡ä»¶

Vite åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ä»ä»¥ä¸‹æ–‡ä»¶åŠ è½½é¢å¤–çš„ç¯å¢ƒå˜é‡ã€‚

```bash
.env                # æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šåŠ è½½
.env.local          # æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šåŠ è½½ï¼Œä½†ä¼šè¢« git å¿½ç•¥
.env.[mode]         # åªåœ¨æŒ‡å®šæ¨¡å¼ä¸‹åŠ è½½
.env.[mode].local   # åªåœ¨æŒ‡å®šæ¨¡å¼ä¸‹åŠ è½½ï¼Œä½†ä¼šè¢« git å¿½ç•¥
```

åŠ è½½çš„ç¯å¢ƒå˜é‡ä¼šé€šè¿‡ `import.meta.env` æš´éœ²ç»™å®¢æˆ·ç«¯æºç ã€‚

> ğŸ’¡ ä¸ºäº†é˜²æ­¢æ„å¤–åœ°å°†ä¸€äº›ç¯å¢ƒå˜é‡æ³„æ¼åˆ°å®¢æˆ·ç«¯ï¼Œåªæœ‰ä»¥ `VITE_`  ä¸ºå‰ç¼€çš„å˜é‡æ‰ä¼šæš´éœ²ç»™ç»è¿‡ vite å¤„ç†çš„ä»£ç ã€‚

ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªæ–‡ä»¶ä¸­ï¼š

```bash
DB_PASSWORD=foobar
VITE_SOME_KEY=123
```

åªæœ‰ VITE_SOME_KEY ä¼šè¢«æš´éœ²ä¸º import.meta.env.VITE_SOME_KEY æä¾›ç»™å®¢æˆ·ç«¯æºç ï¼Œè€Œ DB_PASSWORD åˆ™ä¸ä¼šã€‚

<br/>

ç”±äºæš´éœ²åœ¨ Vite æºç ä¸­çš„ä»»ä½•å˜é‡éƒ½å°†æœ€ç»ˆå‡ºç°åœ¨å®¢æˆ·ç«¯åŒ…ä¸­ï¼Œ `VITE_*` å˜é‡åº”è¯¥ä¸åŒ…å«ä»»ä½•æ•æ„Ÿä¿¡æ¯ã€‚

> ğŸ’¡ `.env.*.local` æ–‡ä»¶åº”æ˜¯æœ¬åœ°çš„ï¼Œå¯ä»¥åŒ…å«æ•æ„Ÿå˜é‡ã€‚ä½ åº”è¯¥åŠ ä¸Š `*.local` åˆ°ä½ çš„ .gitignore ä»¥é¿å…ä»–ä»¬è¢«ä¸Šä¼ åˆ° gitã€‚

### è¿è¡Œæ¨¡å¼

Viteé¡¹ç›®åˆ›å»ºä»¥åï¼Œé»˜è®¤æœ‰ä¸‰ä¸ªè¿è¡Œè„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```json
"scripts": {
  "dev": "vite",
  "build": "vue-tsc --noEmit && vite build",
  "serve": "vite preview"
}
```

 `serve` æˆ–è€… `dev` å‘½ä»¤è¿è¡Œåœ¨ `development` ï¼ˆå¼€å‘ï¼‰æ¨¡å¼ï¼Œè€Œ `build` å‘½ä»¤è¿è¡Œåœ¨ `production` ï¼ˆç”Ÿäº§ï¼‰æ¨¡å¼ã€‚

è¿™æ„å‘³ç€å½“æ‰§è¡Œ `npm run dev` æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ è½½ `.env.development` ä¸­çš„ç¯å¢ƒå˜é‡ï¼š

```bash
# .env.development
VITE_APP_TITLE = My App
```

åœ¨åº”ç”¨ä¸­å¯ä»¥ä½¿ç”¨ `import.meta.env.VITE_APP_TITLE` ä½œä¸ºæ¸²æŸ“æ ‡é¢˜ã€‚

<br/>

å¯ä»¥é€šè¿‡ä¼ é€’ `--mode` é€‰é¡¹æ ‡å¿—æ¥è¦†ç›–å‘½ä»¤ä½¿ç”¨çš„é»˜è®¤æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³ä¸ºæˆ‘ä»¬å‡è®¾çš„testæ¨¡å¼æ„å»ºåº”ç”¨ï¼š

```tsx
npm run build --mode test
```

è¿™æ—¶éœ€è¦æœ‰ä¸€ä¸ª `.env.test` æ–‡ä»¶ã€‚

### å†…ç½®å˜é‡

Vite åœ¨ `import.meta.env` å¯¹è±¡ä¸Šæš´éœ²ç¯å¢ƒå˜é‡ã€‚ä¸‹é¢æœ‰ä¸€äº›å¸¸ç”¨çš„å†…å»ºå˜é‡ï¼š

- `import.meta.env.MODE`:Â `string` åº”ç”¨å½“å‰è¿è¡Œçš„æ¨¡å¼ã€‚
- `import.meta.env.BASE_URL`:Â `string` åº”ç”¨æ­£è¢«éƒ¨ç½²åœ¨çš„ base URLã€‚å®ƒç”± `base` é…ç½®é¡¹å†³å®šã€‚
- `import.meta.env.PROD`:Â `boolean` åº”ç”¨æ˜¯å¦è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒã€‚
- `import.meta.env.DEV`:Â `boolean` åº”ç”¨æ˜¯å¦è¿è¡Œåœ¨å¼€å‘ç¯å¢ƒã€‚

## ğŸ¯ ç›®æ ‡

è·å– development æ¨¡å¼ä¸‹çš„å†…å»ºç¯å¢ƒå˜é‡å’Œè‡ªå®šä¹‰ç¯å¢ƒå˜é‡ã€‚

## ğŸŒˆ Coding

### åˆ›å»º env æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º `.env.development` æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

```text
# ä¸»æœºå
VITE_HOST = 127.0.0.1

# ç«¯å£å·
VITE_PORT = 3000

# åŸºç¡€è·¯å¾„
VITE_BASE_URL = '/api'
```

> ğŸ’¡ ä¿®æ”¹ç¯å¢ƒå˜é‡åè¦é‡å¯é¡¹ç›®æ‰èƒ½ç”Ÿæ•ˆã€‚

### è¯»å–ç¯å¢ƒå˜é‡

åœ¨ `HelloWorld.vue` è¯»å–ç¯å¢ƒå˜é‡ï¼Œä»£ç å¦‚ä¸‹ï¼š

```vue
<template>
  <!-- â†“ç¯å¢ƒå˜é‡demo -->
  <div>
    <h2>ç¯å¢ƒå˜é‡</h2>
    mode: {{ mode }} <br />
    host: {{ host }} <br />
    port: {{ port }} <br />
    baseUrl: {{ baseUrl }}
  </div>
</template>

<script lang="ts">
import { defineComponent } from "vue";

export default defineComponent({
  name: "HelloWorld",
  setup() {
    // â†“è¯»å–å†…å»ºç¯å¢ƒå˜é‡
    const mode = import.meta.env.MODE;
    // â†“è¯»å–è‡ªå®šä¹‰ç¯å¢ƒå˜é‡
    const host = import.meta.env.VITE_HOST;
    const port = import.meta.env.VITE_PORT;
    const baseUrl = import.meta.env.VITE_BASE_URL;
    // â†“è¿”å›å˜é‡ï¼Œä½¿æ”¯æŒtemplateè·å–
    return {
      mode,
      host,
      port,
      baseUrl,
    };
  },
});
</script>
```

## ğŸ­ ç»“æœ

é¡µé¢æ˜¾ç¤º4ä¸ªç¯å¢ƒå˜é‡çš„å€¼ã€‚åˆ†åˆ«ä¸ºï¼šâ€œdevelopmentâ€ã€â€œ127.0.0.1â€ã€â€œ3000â€ã€â€œ/apiâ€ã€‚

