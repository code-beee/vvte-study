# 嵌套路由（2）

## 🌈Coding

### 迁移Study内容

上一章我们已经实现了嵌套路由的功能，但之前 Study.vue 中的内容已经看不到了。为了方便学习，执行以下改造：

---

将 Study.vue 中的内容复制到 Home.vue，并将 Go to Home 的 router-link 改为 Go to User 。因为Home页面路由跳转到Home页面没有意义。

> 保留Go to Login，Login页面属于非嵌套路由，可以用来和嵌套路由对比。

修改后的 `Home.vue` 文件内容如下：

```tsx
<template>
  <!-- ↓环境变量demo -->
  <div>
    <h1 class="red">环境变量</h1>
    host: {{ host }} <br />
    port: {{ port }} <br />
    open: {{ open }} <br />
    baseUrl: {{ baseUrl }}
  </div>
  <!-- ↓路由demo -->
  <div>
    <h1 class="blue">路由</h1>
    <!-- ↓匹配路由path进行跳转 -->
    <router-link to="/sys/user">Go to User 嵌套路由</router-link> <br />
    <!-- ↓匹配路由name进行跳转，防止硬编码的URL -->
    <router-link :to="{ name: 'login' }">Go to Login 非嵌套路由</router-link>
  </div>
</template>

<script lang="ts">
import { defineComponent } from "vue";
import "@/styles/index.scss";

export default defineComponent({
  name: "Home",
  setup() {
    // ↓读取环境变量
    const host = import.meta.env.VITE_HOST;
    const port = import.meta.env.VITE_PORT;
    const open = import.meta.env.VITE_OPEN;
    const baseUrl = import.meta.env.VITE_BASE_URL;
    // ↓返回变量，使其在html元素中能够读取
    return {
      host,
      port,
      open,
      baseUrl,
    };
  },
});
</script>
```

> 完成后可删除 Study.vue 文件

User 中加入返回 Home 的 router-link ，修改后的 `User.vue` 文件内容如下：

```html
<template>
  <h1>User Page</h1>
  <router-link :to="{ name: 'home' }">Go to Home</router-link> <br />
</template>
```

### 路由别名

尽管访问根路径能跳转到 /home，但由于是重定向，浏览器的URL也发生了改变，URL后面带上了子路径，可以使用路由`别名`来解决这个问题。

> URL中的 # 号是因为创建路由时的历史模式选的 hash 模式，由 `createWebHashHistory()` 创建。除了外观以外，它在 SEO 中也有不好的影响。可用HTML5作为历史模式来解决，创建方式为 `createWebHistory()`。详细解决办法参考 [官网文档](https://next.router.vuejs.org/zh/guide/essentials/history-mode.html#html5-%E6%A8%A1%E5%BC%8F)

需要将 /home 别名为 /，意味着当用户访问 / 时，URL 仍然是 /，但会被匹配为用户正在访问 /home。

在 /home 中添加 `alias` ，`router/index.ts` 修改的内容如下：

```tsx
......
// ↓首页
{
  path: '/home',
  name: 'home',
  // ↓路由别名
  alias: '/',
  component: () => import('@/views/Home.vue')
},
......
```

### 显示效果

#### 添加样式

现在从页面上看不出布局和嵌套路由的效果，下面勾勒下Layout的轮廓。勾勒轮廓要有样式，先调整样式文件目录结构。

style文件目录结构如下:

📁 src

\----📁 styles

\----\----📁 common

\----\----\----📄 box.scss

\----\----\----📄 display.scss

\----\----\----📄 font.scss

\----\----📁 variable

\----\----\----📄 color.scss

\----\----📄 index.scss

> 样式子目录说明：
>
> - common — 存放常用普通样式文件
> - variable — 存放变量

------

`box.scss` 中内容如下：

```scss
.red-border {
  border: 1px solid $color-red
}

.blue-border {
  border: 1px solid $color-blue
}

.green-border {
  border: 1px solid $color-green
}
```

`display.scss` 中内容如下：

```scss
.flex {
  display: flex;
}
.flex-1{
  flex: 1;
}
```

`font.scss` 中新增样式，内容如下：

```scss
......

.text-center {
  text-align: center;
}
```

`color.scss` 中内容如下：

```scss
$color-red: #FF2F64;
$color-green: #009688;
$color-blue: #034AFF;
$color-yellow: #FFAE22;
$color-grey: #909399;
```

`index.scss` 中导入新增的样式文件，内容如下：

```scss
@import './variable/color.scss';
@import './common/font.scss';
@import './common/box.scss';
@import './common/display.scss';
```

#### 拼装Layout

在 Layout 中简单画出布局轮廓，`layout/index.vue` 中内容如下：

```html
<template>
  <!-- ↓上层navbar -->
  <div class="red-border text-center">
    <h3>Header</h3>
  </div>
  <!-- ↓中层 -->
  <div class="flex">
    <!-- ↓sidebar -->
    <div class="green-border text-center">
      <h3>Sidebar</h3>
    </div>
    <!-- ↓content -->
    <div class="flex-1 text-center">
      <!-- ↓layout下的路由出口 -->
      <router-view></router-view>
    </div>
  </div>
  <!-- ↓下层footer -->
  <div class="blue-border text-center">
    <h3>Footer</h3>
  </div>
</template>

<script>
import "@/styles/index.scss";
</script>
```

------

> 在页面已经能看到布局效果，点击路由标签也能体验嵌套路由功能。现在页面丑了点，以后会“改头换面”的。